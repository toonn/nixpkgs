From b1988da757b4fde1721986d58d2127498913a5b2 Mon Sep 17 00:00:00 2001
From: toonn <toonn@toonn.io>
Date: Mon, 18 Jul 2022 15:16:42 +0200
Subject: [PATCH 4/7] val_secalgo: Replace EVP_MD_CTX_cleanup with _free

---
 unbound/validator/val_secalgo.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/unbound/validator/val_secalgo.c b/unbound/validator/val_secalgo.c
index 584e082..4c9d329 100644
--- a/unbound/validator/val_secalgo.c
+++ b/unbound/validator/val_secalgo.c
@@ -531,7 +531,7 @@ verify_canonrrset(sldns_buffer* buf, int algo, unsigned char* sigblock,
 	}
 
 	res = EVP_VerifyFinal(&ctx, sigblock, sigblock_len, evp_key);
-	if(EVP_MD_CTX_cleanup(&ctx) == 0) {
+	if(EVP_MD_CTX_free(&ctx) == 0) {
 		verbose(VERB_QUERY, "verify: EVP_MD_CTX_cleanup failed");
 		EVP_PKEY_free(evp_key);
 		if(dofree) free(sigblock);
-- 
2.17.2 (Apple Git-113)

